<!--
	Large loop with conditions and ternary operators.
-->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<body>
	<script type="module">
		import Signalize from 'signalizejs';
		import directives from 'signalizejs/directives';
		import traverseDomPlugin from 'signalizejs/traverse-dom';
		import evaluator from 'signalizejs/evaluator';
		import ifDirective from 'signalizejs/directives/if';
		import forDirective from 'signalizejs/directives/for';

		const { component, signal } = new Signalize({
			plugins: [
				traverseDomPlugin(),
				evaluator(),
				directives(),
				ifDirective(),
				forDirective()
			]
		});

		component('todo-form', {
			construct: () => {
				const items = signal({});
				const text = signal('');

				const submit = (event) => {
					event.preventDefault();
					items({...items(), [text()]: text()})
					text('');
				}

				return {
					items,
					text,
					keys: () => Object.keys(items()).sort(),
					deleteItem: (item) => {
						const newItems = items();
						delete newItems[item];
						items(newItems);
					},
					submit
				}
			}
		})
	</script>

	<todo-form>
		<form $items="{}" $text="" @submit="submit">
			<input :value="text">
		</form>
		<ul>
			<template :for="item of keys()">
				<li :key="item">
					<a role="button" @click="deleteItem(item())">
						<span :text="item"></span> - X
					</a>
				</li>
			</template>
		</ul>
	</todo-form>
</body>
</html>
