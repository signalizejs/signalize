<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta snippet="spa-cache-control" name="spa-cache-control" content="cache">
	<title snippet="title">Index page</title>
</head>

<body>
	<style>
		[cloak] {
			visibility: hidden;
		}
	</style>

	<script type="importmap">
		{
			"imports": {
				"signalizejs": "/packages/signalizejs/src/Signalize.js",
				"signalizejs/directives": "/packages/signalizejs/src/plugins/directives.js",
				"signalizejs/traverse-dom": "/packages/signalizejs/src/plugins/traverse-dom.js",
				"signalizejs/evaluator": "/packages/signalizejs/src/plugins/evaluator.js"
			}
		}
	</script>

	<script type="module">
		import Signalize from 'signalizejs';
		import Evaluate from 'signalizejs/evaluator';
		import TraverseDom from 'signalizejs/traverse-dom';
		import Directives from 'signalizejs/directives';

		const { component, bind, signal } = new Signalize({ plugins: [
			Evaluate(),
			TraverseDom(),
			Directives()
		] });

		component('x-a', ({ $refs, $connected }) => {
			/* const child = $refs.child; */
			const number = signal(40);

			number.watch(( ) => {
				console.log('WatchA', number());
			});

			return {
				number,
				/* change: () => {
					console.trace('A', event);
				} */
			}
		});

		setTimeout(() => {
			component('x-b', {
				props: {
					number: 0,
					/* change: (event) => {
						console.log('fuck', event);
					} */
				},
				setup({ $props, $refs }) {
					$props.number.watch(({ newValue }) => {
						console.log('WatchB', newValue);
					});

					return {
						number: $props.number
						/* change: () => {
							console.log('e');
							$props.change()(event)
						} */
						/* change: () => {
							console.log('meh');
						} */
					}
				}
			});
		}, 1000);
	</script>

	<x-a>
		<x-b {number}>
			<input :value="number">
		</x-b>
	</x-a>
</body>

</html>
